# Network Sniffing

Let's recap ong the main points that we've explored so far this week.

Computer networks are made up of several layers.  

While it's important to know, in overview, how the layers function together, communications between clients and servers happen on the network layer.  It is, therefore, this layer that we'll focus on this layer during a course on communications network security.  

Most interactions between a client and a server on this layer occur using IP/TCP.  The IP identifies _where_ to send packets of data to and from, using IP addresses.  The TCP handles the transfer of this data by ensuring a reliable connection between the client and the server.

### Compromising networks

This system is good, but it's not perfect.  

Ulimately, no matter what their motivation, every hacker is trying to compromise and gain access to a target system.  Before the hacker can do this, they need know a fair bit about their target systems and the tools they can use to find the system's vulnerability.  We can use these same tools to audit our own system's vulnerabilities and help to make them more secure.  That way, if we know our system's vulnerabilities, we have chances to fix them before someone exploits them.

Many current computer networks are vulnerable to sniffer tools.  Let's take a look at some of the flaws that make network sniffing an easy task.

### How Ethernet functions (at Data Link layer) - CSMA/CD

Before we discuss the packet sniffing tools, we need to understand the function of data link layer (and, in particular, the Ethernet). There are often many devices attached to the same [network segment](http://www.linfo.org/network_segment.html). What happens if all the devices try to send a message at the same time on the shared segment?  Often, you may end up with a data collision, where packets of data collide with one-another, resulting in useless garbled messages.

![GitHub Logo](./images/CSMA-CD.gif)
<!--- (source: http://pharoah-net.blogspot.com.au/2011/12/logical-topology.html -->

Let's take an example to understand how this works more clearly. 

When I was a child in school, I knew two identical twin boys who were always placed into different classes.  Ocassionally, they would play a prank by switching places.  Especially as they grew older and a little more sophisticated, it would sometimes take quite a while for the teachers to figure out there waas a child in their class who shouldn't be there.

Now, imagine we are in such a classroom with 30 students, when the teacher asks a question.  If all 30 students start speaking at the same time, would it be possible for a teacher to listen to an answer clearly? Obviously, no. Why? Because of a collision between every student's voice signals which are travelling in the same classroom. What would be the solution? Before speaking, every student should if someone else is speaking at the same time. If so, the student will wait for a while and try again later. If not, the student will start speaking instantly. The CMSA/CD works in exactly the same way.

Why does this matter in a course on network security?  As you have probably already figured out, sometimes someone is in the classroom who's not meant to be there.

Similarly, the CMSA/CD means that multiple devices are using the same physical cable while sending, receiving and listening in to the data.  If you wanted to sense (or 'sniff') each and every packet travelling around the same network segment, this would be a simple task.  I'd simply need to go to the data link layer and install Wireshark or any other packet sniffer.

The process of capturing network traffic and inspecting it closely to determine what is happening on the network is called Network Analysis. 

![GitHub Logo](./images/packet-sniffing.jpg)
<!--- (source: https://i0.wp.com/latesthackingnews.com/wp-content/uploads/2017/08/Packet-sniffing.jpg?resize=728%2C445&ssl=1
 -->

A network analyzer tool decodes the data packets of common protocols and displays the network traffic in a human-readable format. We can call network analysis as either sniffing or packet analysis or protocol analysis or eavesdropping or traffic analysis. Sniffing is the more popular name by the way.

### How can we differentiate different network analyzers?

The network analyzer can be the combination of either hardware and software or just a software. The major difference between various network analyzer is the no. of protocols they understand and decode. In addition, the quality of decoding, the user interface and graphing statistical capabilities may vary between different network analyzers.

### How Man-in-the-Middle can use Sniffers?
* Compromising proprietary information
* Capturing clear-text usernames and passwords
* Capturing and replaying Voice over IP telephone conversations
* Mapping a network
* Passive OS fingerprinting

### How Man-in-the-Middle start the sniffing process?
The first attacker gains an access to the communication cable of the targeted system by tapping into the cable somewhere between the path of the communications. There are ways to achieve this as below:
* Physically sense the data from the cable.
* Breaking into a target computer, install sniffing software and control it remotely.
* Breaking into an Internet Service Provider(ISP), install sniffing software and control it remotely.
* Find out the existing system at ISP which has already sniffing software installed.
* Using social engineering to gain physical access at an ISP to install a packet sniffer.
* Having an insider partner in crime at the target organization or ISP who can install a sniffing software.
* Diverting communication to a path that includes the intruder's computer.

## Common Network Analyzer Tools
**Wireshark (formerly known as Ethereal)** , **Cain and Abel** , **tcpdump** , **Kismet** , **Ettercap** , **NetStumbler** , **dsniff** , **Carnivore (by FBI)** , **Ntop** , **Ngrep** , **EtherApe** , **NetworkMiner** , **P0f** , **inSSIDer** , **KisMAC**

### Your task
Investigate the difference between CSMA/CA and CSMA/CD. Which one would you consider using? Compare various packet sniffers and find out which one works with GUI and which one supports CLI. Which packet sniffers are supported by Windows, macOS, Linux, BSDs and Solaris? Which one would you prefer?
