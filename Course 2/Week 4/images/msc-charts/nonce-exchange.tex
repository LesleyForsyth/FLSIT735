\documentclass{standalone}

\usepackage{msc}
\begin{document}

\begin{msc}[small values, instance
distance=7cm]{A key exchange protocol}

\declinst{browser}{ }{Browser}
\declinst{server}{}{Server}

\mess{Hello, is this amazon?}{browser}{server}
\nextlevel
\nextlevel
\mess{Yes, here is my certificate $Cert_{Amazon}$}{server}{browser}
\nextlevel
\action*{Validate $Cert_{Amazon}$}{browser}
\nextlevel
\nextlevel
\action*{Extract $pk_{Amazon}$}{browser}
\nextlevel
\nextlevel
\nextlevel
\mess{Ok, let's use this shared key: \\
$\{$72AE25495A...$\}_{pk_{Amazon}}$}{browser}{server}
\nextlevel
\nextlevel
\nextlevel
\mess*{The following traffic is encrypted with 
``72AE25495A..."}{browser}{server}
\nextlevel
\mess*{}{server}{browser}
\nextlevel
\mess*{}{browser}{server}
\nextlevel
\mess*{}{server}{browser}
\nextlevel
\mess*{}{browser}{server}
\nextlevel
\mess*{}{server}{browser}
\nextlevel
\end{msc}

\end{document}