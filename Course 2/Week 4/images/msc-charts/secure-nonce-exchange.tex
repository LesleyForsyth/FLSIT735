\documentclass{standalone}

\usepackage{msc}
\begin{document}

\begin{msc}[small values, instance
distance=7cm]{A secure key exchange protocol}

\declinst{browser}{ }{Browser}
\declinst{server}{}{Server}

\mess{Hello, is this amazon?, use this nonce $n$}{browser}{server}
\nextlevel
\nextlevel
\mess{Yes, my certificate $Cert_{Amazon}$ and my nonce $m$}{server}{browser}
\nextlevel
\action*{Validate $Cert_{Amazon}$}{browser}
\nextlevel
\nextlevel
\action*{Extract $pk_{Amazon}$}{browser}
\nextlevel
\nextlevel
\action*{Create pre-master key $k_{pre}$}{browser}
\nextlevel
\nextlevel
\action*{Derive master key $k_{master} = h(k_{pre}, m, n)$}{browser}
\nextlevel
\nextlevel
\nextlevel
\mess{If you are amazon, then derive key from
$\{k_{pre}\}_{pk_{Amazon}}$}{browser}{server}
\nextlevel
\action*{Decrypt $\{k_{pre}\}_{pk_{Amazon}}$}{server}
\nextlevel
\nextlevel
\action*{Derive master key $k_{master} = h(k_{pre}, m, n)$}{server}
\nextlevel
\nextlevel
\nextlevel
\mess{Done, here is the proof: $\{$Server-Done$, m, 
n\}_{k_{master}}$}{server}{browser}
\nextlevel
\action*{Check $k_{master}$ is correct}{browser}
\nextlevel
\nextlevel
\nextlevel
\mess{The key is correct, my proof: $\{$Client-Done$, m, 
n\}_{k_{master}}$}{server}{browser}
\nextlevel
\nextlevel
\mess*{The following traffic is encrypted with 
$k_{master}$}{browser}{server}
\nextlevel
\mess*{}{server}{browser}
\nextlevel
\mess*{}{browser}{server}
\nextlevel
\mess*{}{server}{browser}
\nextlevel
\mess*{}{browser}{server}
\nextlevel
\mess*{}{server}{browser}
\nextlevel
\end{msc}

\end{document}